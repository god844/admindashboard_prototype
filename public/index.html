<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Professional Management System</title>
  
  <!-- Use development builds for Babel compatibility -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
  
  <style>
    @keyframes blob {
      0%, 100% { transform: translate(0, 0) scale(1); }
      33% { transform: translate(30px, -50px) scale(1.1); }
      66% { transform: translate(-20px, 20px) scale(0.9); }
    }
    .animate-blob {
      animation: blob 7s infinite;
    }
    .animation-delay-2000 {
      animation-delay: 2s;
    }
    .animation-delay-4000 {
      animation-delay: 4s;
    }
    
    * {
      scrollbar-width: thin;
      scrollbar-color: rgba(59, 130, 246, 0.5) rgba(239, 246, 255, 0.5);
    }
    
    *::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    *::-webkit-scrollbar-track {
      background: rgba(239, 246, 255, 0.5);
      border-radius: 10px;
    }
    
    *::-webkit-scrollbar-thumb {
      background: rgba(59, 130, 246, 0.5);
      border-radius: 10px;
    }
    
    *::-webkit-scrollbar-thumb:hover {
      background: rgba(59, 130, 246, 0.7);
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <!-- Lucide Icons as inline SVG helpers -->
  <script>
    // Simple icon components
    const createIcon = (path) => {
      return React.createElement('svg', {
        xmlns: "http://www.w3.org/2000/svg",
        width: "24",
        height: "24",
        viewBox: "0 0 24 24",
        fill: "none",
        stroke: "currentColor",
        strokeWidth: "2",
        strokeLinecap: "round",
        strokeLinejoin: "round",
        className: "inline-block"
      }, React.createElement('path', { d: path }));
    };
  </script>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // Simple icon components
    const Upload = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="17 8 12 3 7 8"/>
        <line x1="12" y1="3" x2="12" y2="15"/>
      </svg>
    );

    const Download = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="7 10 12 15 17 10"/>
        <line x1="12" y1="15" x2="12" y2="3"/>
      </svg>
    );

    const Database = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <ellipse cx="12" cy="5" rx="9" ry="3"/>
        <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/>
        <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>
      </svg>
    );

    const School = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <path d="M22 10v6M2 10l10-5 10 5-10 5z"/>
        <path d="M6 12v5c3 3 9 3 12 0v-5"/>
      </svg>
    );

    const Settings = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <circle cx="12" cy="12" r="3"/>
        <path d="M12 1v6m0 6v6"/>
      </svg>
    );

    const Filter = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
      </svg>
    );

    const Plus = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <line x1="12" y1="5" x2="12" y2="19"/>
        <line x1="5" y1="12" x2="19" y2="12"/>
      </svg>
    );

    const X = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <line x1="18" y1="6" x2="6" y2="18"/>
        <line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    );

    const Search = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <circle cx="11" cy="11" r="8"/>
        <path d="m21 21-4.35-4.35"/>
      </svg>
    );

    const Bell = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
        <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
      </svg>
    );

    const Edit2 = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
      </svg>
    );

    const Save = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
        <polyline points="17 21 17 13 7 13 7 21"/>
        <polyline points="7 3 7 8 15 8"/>
      </svg>
    );

    const Check = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <polyline points="20 6 9 17 4 12"/>
      </svg>
    );

    const Clock = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <circle cx="12" cy="12" r="10"/>
        <polyline points="12 6 12 12 16 14"/>
      </svg>
    );

    const AlertCircle = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="8" x2="12" y2="12"/>
        <line x1="12" y1="16" x2="12.01" y2="16"/>
      </svg>
    );

    const Calendar = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
        <line x1="16" y1="2" x2="16" y2="6"/>
        <line x1="8" y1="2" x2="8" y2="6"/>
        <line x1="3" y1="10" x2="21" y2="10"/>
      </svg>
    );

    const API_URL = window.location.origin;

    const AdminDashboard = () => {
      const [activeTab, setActiveTab] = useState('upload');
      const [columns, setColumns] = useState([]);
      const [newColumn, setNewColumn] = useState('');
      const [uploadedData, setUploadedData] = useState([]);
      const [filteredData, setFilteredData] = useState([]);
      const [filters, setFilters] = useState({});
      const [filterTypes, setFilterTypes] = useState({});
      const [uniqueValues, setUniqueValues] = useState({});
      const [schools, setSchools] = useState([]);
      const [editingSchool, setEditingSchool] = useState(null);
      const [newSchool, setNewSchool] = useState({ name: '', status: 'pending', start_date: '', deadline: '', priority: 1 });
      const [searchTerm, setSearchTerm] = useState('');
      const [notifications, setNotifications] = useState([]);
      const [loading, setLoading] = useState(false);

      useEffect(() => {
        fetchColumns();
        fetchData();
        fetchSchools();
        fetchNotifications();
      }, []);

      useEffect(() => {
        applyFilters();
      }, [filters, uploadedData]);

      const fetchColumns = async () => {
        try {
          const response = await fetch(`${API_URL}/api/columns`);
          const data = await response.json();
          const cols = data.map(col => col.column_name);
          setColumns(cols);
          
          // Set filter types
          const types = {};
          cols.forEach(col => {
            types[col] = ['grade', 'subject', 'status', 'school'].includes(col) ? 'select' : 'text';
          });
          setFilterTypes(types);
        } catch (error) {
          console.error('Error fetching columns:', error);
        }
      };

      const fetchData = async () => {
        try {
          const response = await fetch(`${API_URL}/api/data`);
          const data = await response.json();
          setUploadedData(data);
          setFilteredData(data);
          extractUniqueValues(data);
        } catch (error) {
          console.error('Error fetching data:', error);
        }
      };

      const extractUniqueValues = (data) => {
        const values = {};
        columns.forEach(col => {
          values[col] = [...new Set(data.map(row => row[col]).filter(Boolean))];
        });
        setUniqueValues(values);
      };

      const fetchSchools = async () => {
        try {
          const response = await fetch(`${API_URL}/api/schools`);
          const data = await response.json();
          setSchools(data);
        } catch (error) {
          console.error('Error fetching schools:', error);
        }
      };

      const fetchNotifications = async () => {
        try {
          const response = await fetch(`${API_URL}/api/notifications`);
          const data = await response.json();
          setNotifications(data);
        } catch (error) {
          console.error('Error fetching notifications:', error);
        }
      };

      const addColumn = async () => {
        if (newColumn && !columns.includes(newColumn)) {
          try {
            await fetch(`${API_URL}/api/columns`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ column_name: newColumn })
            });
            setColumns([...columns, newColumn]);
            setFilterTypes({...filterTypes, [newColumn]: 'text'});
            setNewColumn('');
          } catch (error) {
            console.error('Error adding column:', error);
          }
        }
      };

      const removeColumn = async (col) => {
        if (!['id', 'name', 'email'].includes(col)) {
          try {
            await fetch(`${API_URL}/api/columns/${col}`, { method: 'DELETE' });
            setColumns(columns.filter(c => c !== col));
          } catch (error) {
            console.error('Error removing column:', error);
          }
        }
      };

      const handleFileUpload = async (e) => {
        const file = e.target.files[0];
        if (file) {
          setLoading(true);
          const formData = new FormData();
          formData.append('file', file);
          
          try {
            const response = await fetch(`${API_URL}/api/upload`, {
              method: 'POST',
              body: formData
            });
            const result = await response.json();
            alert(`âœ… Successfully uploaded ${result.count} records!`);
            fetchColumns();
            fetchData();
          } catch (error) {
            alert('âŒ Error uploading file: ' + error.message);
          } finally {
            setLoading(false);
          }
        }
      };

      const applyFilters = () => {
        let filtered = [...uploadedData];
        Object.keys(filters).forEach(key => {
          if (filters[key]) {
            if (filterTypes[key] === 'select') {
              filtered = filtered.filter(item => item[key] === filters[key]);
            } else {
              filtered = filtered.filter(item => 
                item[key]?.toString().toLowerCase().includes(filters[key].toLowerCase())
              );
            }
          }
        });
        setFilteredData(filtered);
      };

      const downloadExcel = () => {
        const csv = [
          columns.join(','),
          ...filteredData.map(row => columns.map(col => row[col] || '').join(','))
        ].join('\n');
        
        const blob = new Blob([csv], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `filtered_data_${new Date().toISOString().slice(0,10)}.csv`;
        a.click();
      };

      const addSchool = async () => {
        if (newSchool.name) {
          try {
            await fetch(`${API_URL}/api/schools`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(newSchool)
            });
            setNewSchool({ name: '', status: 'pending', start_date: '', deadline: '', priority: 1 });
            fetchSchools();
            fetchNotifications();
          } catch (error) {
            console.error('Error adding school:', error);
          }
        }
      };

      const updateSchool = async (id, updates) => {
        try {
          await fetch(`${API_URL}/api/schools/${id}`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(updates)
          });
          fetchSchools();
          fetchNotifications();
          setEditingSchool(null);
        } catch (error) {
          console.error('Error updating school:', error);
        }
      };

      const deleteSchool = async (id) => {
        if (confirm('Are you sure you want to delete this school?')) {
          try {
            await fetch(`${API_URL}/api/schools/${id}`, { method: 'DELETE' });
            fetchSchools();
          } catch (error) {
            console.error('Error deleting school:', error);
          }
        }
      };

      const getStatusColor = (status) => {
        switch(status) {
          case 'completed': return 'from-emerald-300 to-teal-400';
          case 'started': return 'from-sky-300 to-blue-400';
          case 'pending': return 'from-amber-300 to-orange-400';
          default: return 'from-gray-300 to-slate-400';
        }
      };

      const clearFilters = () => {
        setFilters({});
      };

      const filteredSchools = schools.filter(school =>
        school.name.toLowerCase().includes(searchTerm.toLowerCase())
      );

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-6">
          <div className="fixed inset-0 overflow-hidden pointer-events-none opacity-20">
            <div className="absolute w-96 h-96 bg-blue-200 rounded-full mix-blend-multiply filter blur-3xl animate-blob"></div>
            <div className="absolute right-0 w-96 h-96 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl animate-blob animation-delay-2000"></div>
            <div className="absolute bottom-0 left-20 w-96 h-96 bg-pink-200 rounded-full mix-blend-multiply filter blur-3xl animate-blob animation-delay-4000"></div>
          </div>

          <div className="max-w-7xl mx-auto relative z-10">
            <div className="bg-white/90 backdrop-blur-sm rounded-2xl p-8 mb-6 border border-blue-100 shadow-lg">
              <div className="flex items-center justify-between flex-wrap gap-4">
                <div>
                  <h1 className="text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2 flex items-center gap-3">
                    <Database />
                    Admin Dashboard
                  </h1>
                  <p className="text-gray-600">Professional Data Management System</p>
                </div>
                {notifications.length > 0 && (
                  <div className="relative cursor-pointer" title={notifications.map(n => n.message).join('\n')}>
                    <Bell />
                    <span className="absolute -top-1 -right-1 bg-rose-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                      {notifications.length}
                    </span>
                  </div>
                )}
              </div>
            </div>

            {notifications.length > 0 && (
              <div className="bg-amber-50/90 backdrop-blur-sm border border-amber-200 rounded-xl p-4 mb-6 shadow-md">
                {notifications.map((notif, idx) => (
                  <div key={idx} className="flex items-center gap-2 text-amber-800 mb-2 last:mb-0">
                    <AlertCircle />
                    <span>{notif.message}</span>
                  </div>
                ))}
              </div>
            )}

            <div className="bg-white/90 backdrop-blur-sm rounded-xl p-2 mb-6 border border-blue-100 flex gap-2 shadow-lg flex-wrap">
              {['upload', 'data', 'schools', 'columns'].map(tab => (
                <button
                  key={tab}
                  onClick={() => setActiveTab(tab)}
                  className={`flex-1 min-w-[140px] py-3 px-6 rounded-lg font-semibold transition-all duration-300 ${
                    activeTab === tab
                      ? 'bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-md scale-105'
                      : 'text-gray-600 hover:bg-blue-50'
                  }`}
                >
                  {tab === 'upload' && <Upload />}
                  {tab === 'data' && <Database />}
                  {tab === 'schools' && <School />}
                  {tab === 'columns' && <Settings />}
                  <span className="ml-2">{tab.charAt(0).toUpperCase() + tab.slice(1)}</span>
                </button>
              ))}
            </div>

            <div className="bg-white/90 backdrop-blur-sm rounded-2xl p-8 border border-blue-100 shadow-lg">
              {activeTab === 'upload' && (
                <div className="space-y-6">
                  <h2 className="text-2xl font-bold text-gray-800 mb-4">Upload Excel Data</h2>
                  <div className="border-4 border-dashed border-blue-300 rounded-xl p-12 text-center hover:border-blue-400 transition-all duration-300 hover:scale-[1.02] cursor-pointer bg-blue-50/50">
                    <input
                      type="file"
                      accept=".xlsx,.xls,.csv"
                      onChange={handleFileUpload}
                      className="hidden"
                      id="fileUpload"
                      disabled={loading}
                    />
                    <label htmlFor="fileUpload" className="cursor-pointer">
                      <Upload />
                      <p className="text-xl text-gray-700 mb-2 mt-4">
                        {loading ? 'Uploading...' : 'Drop your Excel file here or click to browse'}
                      </p>
                      <p className="text-gray-500">Supports .xlsx, .xls, .csv formats</p>
                    </label>
                  </div>
                  <div className="text-gray-600 bg-blue-50/70 p-4 rounded-lg border border-blue-200">
                    <p className="font-semibold text-lg">ðŸ“Š Total Records: {uploadedData.length}</p>
                    <p className="text-sm mt-2">ðŸ’¡ Columns are automatically detected from your Excel file</p>
                  </div>
                </div>
              )}

              {activeTab === 'data' && (
                <div className="space-y-6">
                  <div className="flex justify-between items-center mb-4 flex-wrap gap-4">
                    <h2 className="text-2xl font-bold text-gray-800">View & Filter Data</h2>
                    <div className="flex gap-3">
                      <button
                        onClick={clearFilters}
                        className="flex items-center gap-2 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg font-semibold hover:bg-gray-200 transition-colors border border-gray-300"
                      >
                        <X />
                        Clear Filters
                      </button>
                      <button
                        onClick={downloadExcel}
                        className="flex items-center gap-2 bg-gradient-to-r from-emerald-400 to-teal-500 text-white px-6 py-3 rounded-lg font-semibold hover:scale-105 transition-transform shadow-md"
                      >
                        <Download />
                        Download Filtered
                      </button>
                    </div>
                  </div>

                  <div className="bg-blue-50/70 rounded-xl p-6 border border-blue-200">
                    <div className="flex items-center gap-2 mb-4">
                      <Filter />
                      <h3 className="text-lg font-semibold text-gray-800">Advanced Filters</h3>
                      <span className="text-sm text-gray-500 ml-2">
                        ({Object.keys(filters).filter(k => filters[k]).length} active)
                      </span>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                      {columns.map(col => (
                        <div key={col} className="bg-white rounded-lg p-4 border border-blue-200 shadow-sm">
                          <label className="text-gray-700 text-sm font-semibold mb-2 block capitalize flex items-center justify-between">
                            {col}
                            <span className="text-xs text-gray-400 font-normal">
                              {filterTypes[col] === 'select' ? '(Select)' : '(Text)'}
                            </span>
                          </label>
                          
                          {filterTypes[col] === 'select' ? (
                            <select
                              className="w-full bg-blue-50 border border-blue-300 rounded-lg px-3 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                              value={filters[col] || ''}
                              onChange={(e) => setFilters({...filters, [col]: e.target.value})}
                            >
                              <option value="">All {col}</option>
                              {uniqueValues[col]?.map(val => (
                                <option key={val} value={val}>{val}</option>
                              ))}
                            </select>
                          ) : (
                            <input
                              type="text"
                              placeholder={`Search ${col}...`}
                              className="w-full bg-blue-50 border border-blue-300 rounded-lg px-3 py-2 text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                              value={filters[col] || ''}
                              onChange={(e) => setFilters({...filters, [col]: e.target.value})}
                            />
                          )}
                        </div>
                      ))}
                    </div>
                  </div>

                  <div className="overflow-x-auto rounded-xl border border-blue-200 shadow-md">
                    <table className="w-full">
                      <thead className="bg-gradient-to-r from-blue-100 to-purple-100">
                        <tr>
                          {columns.map(col => (
                            <th key={col} className="px-6 py-4 text-left text-gray-700 font-semibold capitalize whitespace-nowrap">
                              {col}
                            </th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        {filteredData.map((row, idx) => (
                          <tr key={idx} className="border-t border-blue-100 hover:bg-blue-50/50 transition-colors">
                            {columns.map(col => (
                              <td key={col} className="px-6 py-4 text-gray-600 whitespace-nowrap">
                                {row[col] || '-'}
                              </td>
                            ))}
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                  <div className="flex justify-between items-center text-gray-600 bg-blue-50/70 p-4 rounded-lg border border-blue-200">
                    <span>Showing {filteredData.length} of {uploadedData.length} records</span>
                    <span className="text-sm">ðŸ’¡ Download exports only filtered data</span>
                  </div>
                </div>
              )}

              {activeTab === 'schools' && (
                <div className="space-y-6">
                  <div className="flex justify-between items-center flex-wrap gap-4">
                    <h2 className="text-2xl font-bold text-gray-800">School Management</h2>
                    <div className="relative">
                      <div className="absolute left-3 top-3 w-5 h-5 text-gray-400">
                        <Search />
                      </div>
                      <input
                        type="text"
                        placeholder="Search schools..."
                        className="pl-10 pr-4 py-2 bg-blue-50 border border-blue-300 rounded-lg text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        value={searchTerm}
                        onChange={(e) => setSearchTerm(e.target.value)}
                      />
                    </div>
                  </div>

                  <div className="bg-blue-50/70 rounded-xl p-6 border border-blue-200">
                    <h3 className="text-lg font-semibold text-gray-800 mb-4">Add New School</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4">
                      <input
                        type="text"
                        placeholder="School Name"
                        className="bg-white border border-blue-300 rounded-lg px-4 py-2 text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        value={newSchool.name}
                        onChange={(e) => setNewSchool({...newSchool, name: e.target.value})}
                      />
                      <select
                        className="bg-white border border-blue-300 rounded-lg px-4 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        value={newSchool.status}
                        onChange={(e) => setNewSchool({...newSchool, status: e.target.value})}
                      >
                        <option value="pending">Pending</option>
                        <option value="started">Started</option>
                        <option value="completed">Completed</option>
                      </select>
                      <input
                        type="date"
                        className="bg-white border border-blue-300 rounded-lg px-4 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        value={newSchool.start_date}
                        onChange={(e) => setNewSchool({...newSchool, start_date: e.target.value})}
                      />
                      <input
                        type="date"
                        className="bg-white border border-blue-300 rounded-lg px-4 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        value={newSchool.deadline}
                        onChange={(e) => setNewSchool({...newSchool, deadline: e.target.value})}
                      />
                      <input
                        type="number"
                        placeholder="Priority"
                        min="1"
                        className="bg-white border border-blue-300 rounded-lg px-4 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        value={newSchool.priority}
                        onChange={(e) => setNewSchool({...newSchool, priority: parseInt(e.target.value)})}
                      />
                      <button
                        onClick={addSchool}
                        className="bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-2 rounded-lg font-semibold hover:scale-105 transition-transform flex items-center justify-center gap-2 shadow-md"
                      >
                        <Plus />
                        Add
                      </button>
                    </div>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    {filteredSchools.map(school => (
                      <div
                        key={school.id}
                        className="bg-white rounded-xl p-6 border border-blue-200 hover:shadow-lg transition-all shadow-md"
                      >
                        {editingSchool === school.id ? (
                          <div className="space-y-3">
                            <input
                              type="text"
                              className="w-full bg-blue-50 border border-blue-300 rounded-lg px-3 py-2 text-gray-700"
                              value={school.name}
                              onChange={(e) => setSchools(schools.map(s => s.id === school.id ? {...s, name: e.target.value} : s))}
                            />
                            <select
                              className="w-full bg-blue-50 border border-blue-300 rounded-lg px-3 py-2 text-gray-700"
                              value={school.status}
                              onChange={(e) => setSchools(schools.map(s => s.id === school.id ? {...s, status: e.target.value} : s))}
                            >
                              <option value="pending">Pending</option>
                              <option value="started">Started</option>
                              <option value="completed">Completed</option>
                            </select>
                            <input
                              type="date"
                              className="w-full bg-blue-50 border border-blue-300 rounded-lg px-3 py-2 text-gray-700"
                              value={school.start_date || ''}
                              onChange={(e) => setSchools(schools.map(s => s.id === school.id ? {...s, start_date: e.target.value} : s))}
                            />
                            <input
                              type="date"
                              className="w-full bg-blue-50 border border-blue-300 rounded-lg px-3 py-2 text-gray-700"
                              value={school.deadline || ''}
                              onChange={(e) => setSchools(schools.map(s => s.id === school.id ? {...s, deadline: e.target.value} : s))}
                            />
                            <input
                              type="number"
                              className="w-full bg-blue-50 border border-blue-300 rounded-lg px-3 py-2 text-gray-700"
                              value={school.priority}
                              onChange={(e) => setSchools(schools.map(s => s.id === school.id ? {...s, priority: parseInt(e.target.value)} : s))}
                            />
                            <div className="flex gap-2">
                              <button
                                onClick={() => updateSchool(school.id, school)}
                                className="flex-1 bg-emerald-400 text-white px-3 py-2 rounded-lg hover:bg-emerald-500 flex items-center justify-center gap-1"
                              >
                                <Save />
                                Save
                              </button>
                              <button
                                onClick={() => setEditingSchool(null)}
                                className="flex-1 bg-gray-200 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-300"
                              >
                                Cancel
                              </button>
                            </div>
                          </div>
                        ) : (
                          <>
                            <div className={`inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r ${getStatusColor(school.status)} text-white font-semibold mb-4`}>
                              {school.status === 'completed' && <Check />}
                              {school.status === 'started' && <Clock />}
                              {school.status === 'pending' && <AlertCircle />}
                              {school.status.toUpperCase()}
                            </div>
                            <h3 className="text-xl font-bold text-gray-800 mb-3">{school.name}</h3>
                            <div className="space-y-2 text-gray-600 mb-4">
                              <p className="text-sm">Priority: {school.priority}</p>
                              {school.start_date && (
                                <p className="text-sm flex items-center gap-2">
                                  <Calendar />
                                  Start: {new Date(school.start_date).toLocaleDateString()}
                                </p>
                              )}
                              {school.deadline && (
                                <p className="text-sm flex items-center gap-2">
                                  <Clock />
                                  Deadline: {new Date(school.deadline).toLocaleDateString()}
                                </p>
                              )}
                            </div>
                            <div className="flex gap-2">
                              <button
                                onClick={() => setEditingSchool(school.id)}
                                className="flex-1 bg-blue-500 text-white px-3 py-2 rounded-lg hover:bg-blue-600 flex items-center justify-center gap-1"
                              >
                                <Edit2 />
                                Edit
                              </button>
                              <button
                                onClick={() => deleteSchool(school.id)}
                                className="px-4 py-2 bg-rose-100 text-rose-600 rounded-lg hover:bg-rose-200"
                              >
                                <X />
                              </button>
                            </div>
                          </>
                        )}
                      </div>
                    ))}
                  </div>
                </div>
              )}

              {activeTab === 'columns' && (
                <div className="space-y-6">
                  <h2 className="text-2xl font-bold text-gray-800 mb-4">Manage Database Columns</h2>
                  
                  <div className="bg-blue-50/70 rounded-xl p-6 border border-blue-200">
                    <h3 className="text-lg font-semibold text-gray-800 mb-4">Add New Column</h3>
                    <div className="flex gap-4">
                      <input
                        type="text"
                        placeholder="Column name..."
                        className="flex-1 bg-white border border-blue-300 rounded-lg px-4 py-2 text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        value={newColumn}
                        onChange={(e) => setNewColumn(e.target.value)}
                        onKeyPress={(e) => e.key === 'Enter' && addColumn()}
                      />
                      <button
                        onClick={addColumn}
                        className="bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-2 rounded-lg font-semibold hover:scale-105 transition-transform flex items-center gap-2 shadow-md"
                      >
                        <Plus />
                        Add Column
                      </button>
                    </div>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    {columns.map(col => (
                      <div
                        key={col}
                        className="bg-white rounded-lg p-4 border border-blue-200 flex items-center justify-between hover:shadow-md transition-shadow"
                      >
                        <span className="text-gray-700 font-semibold capitalize">{col}</span>
                        {!['id', 'name', 'email'].includes(col) && (
                          <button
                            onClick={() => removeColumn(col)}
                            className="text-rose-500 hover:text-rose-600 hover:scale-110 transition-transform"
                          >
                            <X />
                          </button>
                        )}
                      </div>
                    ))}
                  </div>
                  <div className="bg-blue-50/70 p-4 rounded-lg border border-blue-200 text-gray-600">
                    <p className="text-sm">
                      ðŸ’¡ <strong>Note:</strong> Core columns (id, name, email) cannot be removed. New columns are automatically detected from uploaded Excel files.
                    </p>
                  </div>
                </div>
              )}
            </div>
          </div>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(AdminDashboard));
  </script>
</body>
</html>
